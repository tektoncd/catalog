---
apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: bentoml
  labels:
    app.kubernetes.io/version: "0.1"
  annotations:
    tekton.dev/categories: Automation, Integration & Delivery
    tekton.dev/pipelines.minVersion: "0.12.1"
    tekton.dev/tags: cli
spec:
  description: >-
    This task allows operations on BentoML services

    BentoML now supports the ability to retrieve artifact bundles via its
    cli. This will allow for in integration with CI, so models can be safely
    packaged into containers and deployed without any manual effort. The
    build context is auto-generated by BentoML and can be easily connected to
    CI/CD pipelines. This task offers a new pattern for data scientists.

  params:
  - name: ARGS
    type: array
    description: BentoML CLI arguments to run
  - name: YATAISERVICE
    type: string
    description: BentoML CLI arguments to run
    default: ""
  steps:
  - name: bento
    image: docker.io/iancoffey/bentoml-python3@sha256:ac99d45853efa4750bd4e5f6bc4ab9a7d7aedce57e7930bbb6ef643f9892915d #tag: latest
    command: ["bentoml"]
    args: ["$(inputs.params.ARGS)"]
    env:
      - name: "BENTOML__YATAI_SERVICE__URL"
        value: "$(inputs.params.YATAISERVICE)"
  workspaces:
  - name: bentoml
    description: The folder where bentoml will write state to
    mountPath: /workspace/bentoml
